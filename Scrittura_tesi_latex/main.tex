% Template Tesi in Fisica (versione completa in un unico file)
%==============================================================
\documentclass[12pt]{report}

% Margini
\usepackage[top=2.5cm, bottom=2.5cm, left=4cm, right=2.5cm, centering, head=21.75 pt]{geometry}

% Interlinea
\linespread{1.5}

% Librerie utili
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{subcaption}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{siunitx}
\usepackage{amssymb}
\usepackage[italian]{babel}
\usepackage[utf8]{inputenc}
\usepackage{scrlayer-scrpage}
\ifoot[]{}
\cfoot[]{}
\ofoot[\pagemark]{\pagemark}
\pagestyle{scrplain}
\usepackage{mathptmx}
\usepackage[hidelinks]{hyperref}
\usepackage{graphicx}
\usepackage{csquotes}
\usepackage[backend=biber, sorting=nty]{biblatex}
\appto{\bibsetup}{\raggedright}
\addbibresource{bibliography.bib}

\usepackage{titlesec}
\usepackage{float}
\usepackage{listings}
\usepackage{xcolor}

% Stile del codice
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\definecolor{darkgray}{rgb}{.4,.4,.4}
\definecolor{navy}{HTML}{000080}
\definecolor{purple}{rgb}{0.65, 0.12, 0.82}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

% Formato intestazioni capitoli
\titleformat{\chapter}[block]{\normalfont\LARGE\bfseries}{\thechapter.}{0.5em}{\LARGE}
\titlespacing*{\chapter}{0pt}{-20pt}{25pt}

\begin{document}

%---------------------------------------------------------------
% FRONTESPIZIO
%---------------------------------------------------------------
\begin{titlepage}
\begin{center}
    {\LARGE{Università degli Studi di Milano-Bicocca \\}}
    {\small{Dipartimento di Fisica "Giuseppe Occhialini"}}\\
    {\small{Corso di Laurea Triennale}}
\end{center}

\begin{figure}[H]
\centering
\includegraphics[width=0.4\textwidth]{logo.png}
\end{figure}

\begin{center}
    {\Large {Analisi spettrale di eventi SEP e stime della dose per missioni interplanetarie}}
\end{center}

\vspace{2cm}

\begin{minipage}[t]{0.47\textwidth}
{\large{\bf Relatore: \\ Massimo Gervasi}}\\[0.5cm]
{\large{\bf Correlatore: \\ Stefano Della Torre}}
\end{minipage}
\hfill
\begin{minipage}[t]{0.47\textwidth}
\raggedleft
{\large{\bf Candidato: \\ Stefano Dolci}}
\end{minipage}

\vspace{25mm}
\centering{\large{\bf ANNO ACCADEMICO 2024/2025}}
\end{titlepage}

\tableofcontents
\clearpage

\clearpage
\setcounter{page}{1}

%---------------------------------------------------------------
% CAPITOLO 1 — INTRODUZIONE
%---------------------------------------------------------------
\chapter{Introduzione}
Nello spazio interplanetario sono principalmente due le sorgenti di radiazione ionizzante per le sonde spaziali: i raggi cosmici galattici (GCR) e le particelle energetiche solari (SEP). Quest'ultime sono particelle ad alta energia (da KeV fino a GeV), emesse durante eventi di attività solare, principalmente protoni (90\% del flusso) ma anche ioni pesanti ed elettroni.
Le SEP sono note per avere energie inferiori rispetto ai GCR, ma la natura imprevedibile delle attività solari a loro legate le rende un rischio significativo per le missioni spaziali, sopratutto quelle interplanetarie dove la magnetosfera terrestre non può offrire protezione. Lo scopo di questo elaborato è proprio quello di analizzare in dettaglio alcuni eventi SEP noti della storia recente e di stimare la dose (TID) che una sonda interplanetaria riceverebbe durante una tipica missione verso Marte.








\section{Particelle Energetiche Solari (SEP)}

La fisica delle SEP è uno dei campi dell'eliofisica, un nuovo termine definito dalla Nasa\cite{nasa_ref} all'inizio di questo millenio per indicare la scienza del Sole congiunta con i suoi effetti sul'ambiente interplanetario. È una disciplina relativamente giovane, agli inizi degli anni 50' Scott Forbush riportò per la prima volta un evento SEP come un improvviso aumento del flusso di particelle energetiche che raggiungevano le camere a nebbia a terra. In quegli anni si conoscevano come candidati solamente i \textit{solar flare}, brillamenti solari, impulsive esplosioni visibili di energia in prossimità della corona solare.
Con l'avvento dei satelliti per osservazioni solari, ad oggi sappiamo che esistono due categorie di SEP:  
\begin{itemize}

    \item[-] SEP impulsivi: brevi e intensi aumenti del flusso di particelle, il plasma intrappolato nelle linee di campo chiuse ad arco del Sole viene accellerato verso la superfice e in fine espulso, questi eventi sono legati prorio ai flare.
    

    \item[-] SEP graduali: si tratta di eventi più lunghi che si possono estendere per più giorni, sono legati alle espulsioni di massa coronale (CME), quando le linee di campo vengono stirate dal vento solare possono rompersi e il plasma intrappolato viene espluso, le particelle presenti nel tragitto vengono costantemente accellerate dall'onda d'urto e guidate verso lo spazio interplanetario. 
\end{itemize}
\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{figures/Tipologia_SEP.png}
\caption{Tipologia di eventi SEP, a sinistra evento impulsivo (Flare) a destra evento graduale (CME). Immagine adattata da "Solar Energetic Particles - Reames" \cite{Solar_Energetic_Particles_Reames}.}
\label{fig:tipologia_sep}
\end{figure} Le differenze tra questi due tipi di eventi sono quindi: la loro origine e durata come spiegato poco fa, questa domina i possibili danni alla strumentazione spaziale, come vedremo il tempo di esposizione è un fattore fondamentale per la dose accumulata; abbiamo poi differenze nell'abbondanza isotopica, per i SEP graduali è stata trovata una diretta corrispondenza con l'abbondanza misurabile nella corona solare, negli strati immediatamente sotto troviamo la cromosfera, una regione dove le temperature raggiungono i 10.000 K, qui elementi con diversi potenziali di prima ionizzazione (FIP) si differenziano, i campi magnetici spingono prima gli elementi con un basso FIP come magnesio, silicio e ferro, e questa impronta si ritrova negli spettri dei SEP graduali. Altre differenze riguardano: la distribuzione angolare, dato che le linee di campo magnetico giocano un ruolo fondamentale nel guidare le particelle espulse, l'intensità dei SEP dipende da quanto "bene" è magneticamente connesso il satellite che fa le misure rispetto alla sorgente; emissioni di segnali radio sono un'altra impronta utile per distinguere i due tipi di eventi. I fasci di elettroni che si propagano rapidamente lungo le linee di campo aperte stimolano le onde di Langmuir nel plasma locale, la frequenza di oscillazione di queste onde $\omega_{p}=\sqrt{n_e}$ diminuisce rapidamente con l'aumentare della distanza dal Sole dove la densità del plasma $n_e$ è più bassa, questa variazione è misurabile a terra come un breve segnale radio di tipo III a questi si associano i SEP impulsivi, l'emissione prodotta invece dalle onde d'urto che si propagano con le CME si dice essere di tipo II, sono più lunghe e la frequenza diminuisce lentamente, in accordo con i meccanismi fisici dei SEP graduali.






\section{Spettri in energia dei SEP}
Arriviamo ora alla distinzione più rilevante per questa tesi, ovvero la differenza tra i due eventi SEP in termini di spettri. Lo spettro è definito come la distribuzione del numero di particelle in funzione della loro energia, è la grandezza più importante per estrarre informazioni sulla fisica di questi meccanismi ma sopratutto per le stime della dose. 
Uno spettro è definito nel seguente modo 
\begin{equation}
    J(E) = \frac{dN}{dEdAdtd\Omega}
\end{equation}
ovvero il numero di particelle $dN$ che attraversa un'area $dA$ in un tempo $dt$ e in un angolo solido $d\Omega$ con energia compresa tra $E$ ed $E+dE$.
In prima approssimazione lo spettro ci dice quante particelle ci sono a una determinata energia e come cambia questa distrubuzione, una formula approssimativa che descrive gli spettri dei SEP è la seguente:

\begin{equation}
    J(E) \propto E^{-\gamma} e^{-E/E_c}
\end{equation}
dove $\gamma$ è detto l'indice spettrale per descrivere la pendenza dello spettro, $E_c$ è l'energia di cut-off che indica dove lo spettro inizia a decadere esponenzialmente.
I SEP impulsivi come abbiamo accennato dipendono da flare, riconnessioni magnetiche localizzate, tempi di accellerazione rapidi, forte selezione magnetica e quindi spettri più duri, tipicamente $\gamma$ è compreso tra 1.5-3 con cut-off a energie basse. Al contrario i SEP graduali sono noti per i loro spettri più morbidi, con $\gamma$ che può superare 4 e cut-off a energie più alte ($>100$MeV). Questo spettro riflette l'accelerazione continua sulle grandi scale dello spazio interplanetario, dove le particelle vengono accelerate più lentamente e possono raggiungere energie più elevate prima di essere espulse nello spazio. Come accennato un primo tentativo (anni '60-'70) utilizzato per descrivere gli spettri dei SEP è quello di usare leggi di potenza pure $J(E)=E^{-\gamma}$ con l'aggiunta di cut-off esponenziali per spiegare i decadimenti ad alte energie.
Esistono principalmente due modelli accettati dalla comunità scientifica per la descrizione della maggior parte dei SEP, e sono anche i due modelli utilizzati per l'analisi di questa tesi. 
Il primo è il modello Ellison-Ramaty (1985) \cite{Ellison-Ramaty},  il quale deriva dalla teoria dell'accelerazione diffusiva da shock, un meccanismo di fermi al primo-ordine che descrive molto bene la fisica dei SEP associati a CME:
\begin{equation}
    J(E) = J_0 E^{-\gamma} e^{-E/E_c}
\end{equation}
Questo modello viene tipicamente utilizzato per descrivere SEP quando si hanno dati su range energetici particolarmente alti.
Il secondo modello introdotto da Band et al.(1993) \cite{Band1993} era stato originariamente sviluppato per descrivere spettri di gamma-ray burst, ma negli anni è stato adottato come modello che meglio descrive la maggiorparte degli spettri SEP su ampi range energetici: 


\begin{equation}
    J(E) = \begin{cases} 
      J_0 E^{-\gamma_a} e^{-E/E_0} & E < (\gamma_b - \gamma_a) E_0 \\
      J_0 E^{-\gamma_b} [(\gamma_b - \gamma_a) E_0]^{(\gamma_b - \gamma_a)} e^{(\gamma_a - \gamma_b)} & E \geq (\gamma_b - \gamma_a) E_0
   \end{cases}
\end{equation}
è una doppia legge di potenza con due indici spettrali, $\gamma_a$ per le basse energie e $\gamma_b$ per le alte energie e un cut-off esponenziale $E_0$, questa forma permette di descrivere un raccordo "morbido" da pochi MeV fino a GeV.
Chiaramente esistono molti altri modelli e persino una versione "combined" che unisce E-R con Band, ma per il contesto di questo elaborato questi due modelli sono sufficienti per descrivere la maggior parte dei SEP.

\section{Dose e danni da radiazione per missioni spaziali}



\chapter{Dati e analisi spettrale}
L'obiettivo principale di questa tesi è quello di partendo dall'analisi spettrale di 8 eventi SEP riuscire a stimare la \textit{Total Ionizing Dose (TID)}, ovvero la quantità di energia depositata in un materiale da radiazione ionizzante che l'elettronica di una sonda modello riceverebbe durante una tipica missione di 6 mesi verso Marte.:
$$ \text{TID} = \frac{E_{dep}}{m} \qquad [Gray (Gy) = 1 J/Kg]$$
L'idea è quella di utilizzare spettri da SEP reali per stimare, tramite simulazione con software di trasporto SR-NIEL, la dose risultante dietro una schermatura; costruire una funzione di trasferimento dose-fluenza D(F) calibrata sugli eventi scelti e infine utilizzare questa funzione di trasferimento per stimare, con il modello probabilistico SAPPHIRE, il contributo dei soli eventi SEP alla dose cumulativa totale per la missione; il tutto in relazione alla schermatura della sonda, alla durata del transito e alla fase del ciclo solare. 

\section{Procedura complessiva}
Nel seguente capitolo viene descritta la procedura sistematica applicata a tutti gli eventi.

\subsection{Fase 1: 8 eventi SEP}
Come punto di partenza sono stati scelti 8 eventi SEP: AUG 1972, OCT 1989, OCT 2003, JAN 2005, JUL 2012, SEP 2017, OCT 2021 e MAY 2024. 
questi rappresentano alcuni tra i più studiati dei rispettivi cicli solari. Il sole è noto per attraversare periodi di massima attività alternati a periodi di quiete su un ciclo di circa 11 anni.
\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{figures/Solar_cycle.png}
\caption{Ciclo solare misurato con progressione del numero di macchie solare, Immagine adattata da \href{https://www.swpc.noaa.gov/products/solar-cycle-progression}{NOAA-Space Weather Prediction Center}.}
\label{fig:ciclo_solare}
\end{figure} Ci sono molte differenze tra i vari cicli solari ed è una distinzione tutt'altro che perfettamente simmetrica ma in generale è noto che durante periodi di massima attività solare si verificano più eventi SEP e più intensi. Alcuni tra questi sono stati scelti in quanto rappresentano lo standard per il \textit{Worst-case scenario}, ovvero l'evento più intenso del rispettivo ciclo solare, questi vengono spesso utilizzati come riferimento per le stime di dose in fase di mission design, AUG 1972, OCT 1989 e OCT 2003 sono lo standard sempre presente in letteratura, anche per questo sono stati scelti, in modo da poter confrontare i risultati ottenuti.


\subsection{Fase 2: Dati e preprocessing}

Per ciascuno di questi 8 eventi sono stati scaricati i dati di flussi differenziali protonici da satelliti come GOES (EPS/HEPAD), ACE (EPAM), STEREO (LET/HET) e IMP-8, tramite principalmente 2 portali, il primo è il sito della Nasa "OMNIWeb" che raccoglie dati in formato standardizzato da molteplici missioni; il secondo è stato il catalogo SEPEM Reference Data Set v3.0 (RDS v3.0), un database realizzato dall'agenzia spaziale europea (ESA) che raccoglie dati di eventi SEP dal 1973 fino ad oggi. 
I satelliti utilizzati hanno detector che misurano i protoni in vari canali energetici, il range energetico varia da pochi KeV fino al GeV. 
I dati scaricati sono stati puliti secondo la seguente procedura: 
\begin{itemize}

    \item[-] Ricampionamento temporale standard per tutti calcolando media su intervallo $\Delta t$=30 min per ridurre rumore da fluttuazioni statistiche.

    \item[-] Selezione di un intervallo temporale di quiete, tipicamente da 5-15 giorni nel periodo precedente all'evento, per stimare il fondo di rumore strumentale e il contributo dei GCR sempre presenti.

    \item[-] Definizione evento: sul periodo di background si calcola la media $\mu$ e la deviazione standard $\sigma$, secondo un metodo proposto da Whitman et al. \cite{WhitmanSEP} si definisce soglia di attivazione:
    $$ \Phi_{\text{thr}} = \mu + 3\sigma $$
    Si sottrae il background e si applica una selezione per la soglia:

    \[
    \Phi_{\text{net}}(t) =
    \begin{cases}
    \Phi_{\text{raw}}(t) - \mu
    & \text{se } \Phi_{\text{raw}}(t) \geq \Phi_{\text{thr}} \\[6pt]
    0 \; (\text{NaN}) 
    & \text{altrimenti}
    \end{cases}
    \]
    questo permette di mitigare artefatti strumentali e flussi non statisticamente significativi nel calcolo della fluenza.
    

\end{itemize}


\subsection{Calcolo della fluenza}

Si calcola la fluenza per ciascun canale energetico integrando nel tempo:$$ F = \int_{t_1}^{t_2} \Phi(E) dt $$ dove $\Phi(E)$ è il flusso differenziale in unità [$\,\mathrm{p}\!\cdot\!\mathrm{cm}^{-2}\!\cdot\!\mathrm{sr}^{-1}\!\cdot\!\mathrm{s}^{-1}\!\cdot\!\mathrm{MeV}^{-1}$], $dt$ è l'intervallo di campionamento in secondi tra due misure consecutive, $t_1$ e $t_2$ sono i tempi di inizio e fine dell'evento.
Per ogni canale k, si sommano i flussi netti per l'intera durata dell'evento: $$ F_k = \sum_{i} \Phi_{\text{net},k}(t_i) \cdot \Delta t $$ Il risultato è appunto la fluenza differenziale totale $F_k$ in unità [$\,\mathrm{p}\!\cdot\!\mathrm{cm}^{-2}\!\cdot\!\mathrm{sr}^{-1}\!\cdot\!\mathrm{MeV}^{-1}$]. A ciascun canale energetico si associa l'energia efficace $E_{eff}[\mathrm{MeV}]$, questo valore può essere o la media geometrica dei due estremi del canale  $E_{eff} = \sqrt{E_{min} \cdot E_{max}}$, oppure quando disponibile si usa il valore riportato nelle tabelle di calibrazione dei sensori. 
Per quanto riguarda le incertezze sulla fluenza sono due i principali contributi: 
\begin{itemize}
    \item[-] Errore sistematico: costante su tutto il canale e proviene dalle calibrazoni dei sensori e si applica al valore di $F_k$ misurato: $\sigma_{sys} = 10-30\%$ tiene conto delle efficienze geometriche e delle cross-calibrazioni tra sensori diversi. 
    \item[-] Errore statistico: conteggi discreti del numero di particelle contate aggiungono l'errore poissoniano $\sigma_{stat} = \sqrt{F_k}$, tipicamente trascurabile per fluenze elevate. 
    \item[] 
\end{itemize}
L'errore totale è dato dalla somma in quadratura dei due: 
$$\sigma_{tot} = \sqrt{\sigma_{sys}^2 + \sigma_{stat}^2}$$ Per ogni punto spettrale ci sono poi le barre d'errore orizzontale sui canali energetici, definite in questo modo: 

$$ \sigma_{low} = |E_{eff} - E_{min}| \quad \sigma_{high} = |E_{max} - E_{eff}| $$

\subsection{FIT spettro}
Dopo aver calcolato la fluenza integrata, sullo spettro viene eseguito un fit con i due modelli E-R e la Band function. Il fit viene eseguito in spazio logaritmico per gestire meglio il salto di circa 8 ordini di grandezza; si usa l'algoritmo di Levenberg-Marquardt per minimizzare il chi-quadro pesato:$$ \chi^2 = \sum_{k=1}^{N} \left(\frac{\log_{10}F_k - \log_{10}\Phi(E_k; \mathbf{p})}{\sigma_{\log,k}}\right)^2 $$
Una volta ottenuti i parametri e la matrice di covarianza per propagare le incertezze su uno spettro continuo si utilizza un campionamento Monte Carlo Bootstrap parametrico:

\begin{itemize}
    \item[-] Si generaro 1000 set di parametri da una ditribuzione multivariata normale $$ \mathbf{p}^{(j)} \sim \mathcal{N}(\hat{\mathbf{p}}, C_{\text{stab}}), \qquad j = 1, \ldots, 1000 $$ dove $\hat{\mathbf{p}}$ sono i parametri migliori ottenuti dal fit e $C_{\text{stab}}$ è la matrice di covarianza stabilizzata.
    \item[-] Per ogni set generato di parametri si ricalcola lo spettro su una griglia discreta di punti equispaziati in spazio logaritmico, per standardizzare la procedura per tutti 8 i SEP è stato scelto un range energetico da 0.05 a 1000 MeV: $$ \Phi^{(j)}(E_i) = SpectralModel(E_i; \mathbf{p}^{(j)}) \qquad  i = 1,...,500$$
    \item[-] per ogni punto si calcola l'intervallo di confidenza al 68\%, ovvero ±1$\sigma$ per una distribuzione gaussiana:
    $$\Phi_{med}(E_i) = \text{mediano}\left\{\Phi^{(j)}(E_i)\right\}_{j=1}^{1000}$$
    $$ \Phi_{16}(E_i) = \text{percentile}_{16}\left\{{\Phi^{(j)}(E_i)}\right\}, \qquad \Phi_{84}(E_i) = \text{percentile}_{84}\left\{{\Phi^{(j)}(E_i)}\right\} $$
    
\end{itemize}

\subsection{Calcolo dose SR-NIEL}
Si ottengono dunque tre spettri, uno per la mediana e due per i limiti di confidenza, si costruisce una tabella con la fluenza $\Phi$ [p·cm$^{-2}$·sr$^{-1}$·MeV$^{-1}$] e l'energia $E$ [MeV], questi vengono esportati in SR-NIEL per il calcolo della fluenza residua dietro la schermatura di alluminio.

\subsection{Modello sonda spaziale}
Il modello rappresentativo della sonda spaziale e della sua elettronica è costruito con schermatura (Al) + strato di silicio (Si) nel quale si calcola la dose. Per lo strato di schermatura si studiano due geometrie: una planare e una sferica. In entrambi i casi si assume una schermatura di alluminio con spessore $X= 3.7cm$ che fornisce uno spessore equivalente di 10g/cm$^2$, il quale rappresenta un valore medio utilizzato per le sonde interplanetarie. Lo spettro di fluenza incidente viene propagato attraverso la schermatura e il codice SR-NIEL resistuisce la fluenza residua $\Phi_{res}(E)$

\section{Dati e strumentazione}


\section{Selezione 8 eventi SEP}

\begin{itemize}
    \item[-] AUG 1972
    \item[-] OCT 1989 
    \item[-] OCT 2003
    \item[-] JAN 2005
    \item[-] JUL 2012
    \item[-] SEP 2017
    \item[-] OCT 2021
    \item[-] MAY 2024
\end{itemize}


\section{Fit spettrale}

Satelliti, strumentazione e detector utilizzati
Range energetico dei dati 
Metodi di pulizia e filtraggio dati 
Durata evento
Incertezze
Calcolo fluenza e FIT con modelli 
Eventuali check e confronti letteratura

%---------------------------------------------------------------
% CAPITOLO 3 — CALCOLO DOSE SRNIEL
%---------------------------------------------------------------
\chapter{Calcolo della dose SRNIEL}

\section{Modello simulazione SRNIEL}

\section{Geometrie e modello della sonda}


\section{Propagazione delle incertezze}

\section{Risultati dosi stimate}
Calcoli dose e propagazione incertezze 
Modello shielding planare e sferico utilizzati per sonda


%---------------------------------------------------------------
% CAPITOLO 4 — ANALISI PROBABILISTICA}
%---------------------------------------------------------------
\chapter{Funzione di trasferimento}




\section{Funzione dose-fluenza D(F)}


\section{Influenza della metrica}




 

%---------------------------------------------------------------
% CAPITOLO 5 — CONFRONTO RISULTATI CON MISSIONI REALI
%---------------------------------------------------------------
\chapter{Stime della dose per la missione}

\section{Modelli probabilistici SEP}


\section{Parametri missionistici}


\section{Simulazioni SAPPHIRE}



\section{Validazione con missioni reali}


\cite{zeitlin2013}

%---------------------------------------------------------------
% CAPITOLO 6 — CONCLUSIONI
%---------------------------------------------------------------
\chapter{Conclusioni e miglioramenti}

Sintesi dei risultati ottenuti
confronto SEP vs GCR
Punti critici di queste stime 
Possibili miglioramenti generali per il lavoro di Tesi 

%---------------------------------------------------------------
% BIBLIOGRAFIA
%---------------------------------------------------------------
\printbibliography[heading=bibintoc, title={Bibliografia}]

%---------------------------------------------------------------
% APPENDICE
%---------------------------------------------------------------
\appendix
\chapter{Appendice}
Materiale aggiuntivo, formule, grafici supplementari.

\end{document}